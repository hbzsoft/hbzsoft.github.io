<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[Ynoi2016] 炸脖龙 I</h1>
<h2>题目背景</h2>
<p>备餐时光，软泞蜥獾</p>
<p>草地中钻孔，日晷下打转</p>
<p>波若歌鹦苟延残喘，迷途绿龟嚎哮迷茫</p>
<p>“当心炸脖龙，我的孩子！</p>
<p>那锋爪利颚，能挠钩撕咬！</p>
<p>注意秋布秋布鸟，你需回避，</p>
<p>那暴躁冒烟恶怪大毛怪！”</p>
<p>手持宝剑鸣真理之语：寻觅强敌豪壮永不息——于噹噹树下稍事休憩，伫立良久，深陷思绪。</p>
<p>当思绪纷乱杂绪之际，炸脖龙双目如烔炬，从阴暗密林奔跃闯出，一路悲鸣低吟时啭啼！</p>
<p>一，二！一，二！一刺再刺，真理之语将敌斩成糜！</p>
<p>取其首级，置之死地，</p>
<p>伴随胜利，驰马归疾。</p>
<p>“真当是你把怪龙斩于马下？</p>
<p>奋勇吾儿！</p>
<p>来我怀里！奔走相告！衣锦还乡！</p>
<p>父喜不自禁窃鸣得意</p>
<p>波若歌鹦苟延残喘，</p>
<p>迷途绿龟嚎哮迷茫，</p>
<p>备餐时光，软泞蜥獾</p>
<p>草地中钻孔，日晷下打转</p>
<p>波若歌鹦苟延残喘，</p>
<p>迷途绿龟嚎哮迷茫”</p>
<p>——《炸脖龙之诗》</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21111.png" /></p>
<p>我喊了出来...却不成人话</p>
<p>只能，像在水中一边融化一边下沉的方糖一样...</p>
<p>失去自己的轮廓...一直沉向最低处</p>
<p>想要爬上去的子午</p>
<p>维持自己是自己的连续体...</p>
<p>溶解的渐渐七零八落的意识...</p>
<p>失去了用来挣扎的双手</p>
<p>失去了用来挣扎的双臂</p>
<p>向下，</p>
<p>向下，</p>
<p>一直沉下去</p>
<p>向着意识的底层</p>
<p>沉陷下去的自我...</p>
<p>逐渐消失的世界...</p>
<p>我看到了世界</p>
<p>失落的...世界...</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21112.png" /></p>
<p>```plain</p>
<p>回归天空的话我就可以成为      了</p>
<p>开什么玩笑，你才不是什么      ！</p>
<p>吵死了！吵死了！我是      ！而且生来就是！</p>
<p>就是因为这个家伙我才失去      的资格的！</p>
<p>呜呜呜，由岐姐姐，由岐姐姐！</p>
<p>...怎么会...由岐姐...</p>
<p>卓司！你这家伙！</p>
<pre><code>    吵死了吵死了！像你这样的普通人懂些什么！
</code></pre>
<p>由岐的血慢慢在冰凉的水泥地上扩散开来</p>
<p>抱在怀里的      在渐渐地流出来        本应成为      而出生</p>
<p>的我的被      妨碍了！</p>
<p>不出生的话我就没法拯救是这个世界！</p>
<pre><code>        所以预言者说能当世界回归天空的此处就是尽头
</code></pre>
<p>只要      回归天空的话！</p>
<p>我有这么可怕吗？</p>
<pre><code>          因为我是要对一切生物下达审判的存在！

   因为哥哥是凡人呢

凡人与天才

                        救世主
</code></pre>
<p>世界</p>
<pre><code>                救世主

            回天之门
</code></pre>
<p>要死的是你！</p>
<pre><code>        我不会死               不会死       诅咒你

   要死的是羽咲

     只要羽咲死了

              间宫              皆

                                守           由

                     岐

                            间宫羽咲

                      可能性

                                和镜

                 终

               终之空

                 空
</code></pre>
<p>```</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21113.png" /></p>
<p>一个婴儿出生了</p>
<p>谁的？</p>
<p>不知道</p>
<p>虽然不知道...
但确实有一个婴儿出生了</p>
<p>嗯...那个婴儿在哭...</p>
<p>呜嘎，呜嘎，地哭着...</p>
<p>听到这个哭声大家都笑了</p>
<p>大家都在为婴儿祝福</p>
<p>母亲也是...</p>
<p>父亲也是...</p>
<p>并且其他人也是...</p>
<p>为那个婴儿的出生...</p>
<p>衷心祝福</p>
<p>世界充满着生命的祝福</p>
<p>但是</p>
<p>但不是这样的</p>
<p>在那里</p>
<p>我</p>
<p>我一个人在那里恐惧着</p>
<p>非常恐惧...</p>
<p>要说为什么的话...</p>
<p>因为那是在对世界进行诅咒</p>
<p>没错...</p>
<p>他在诅咒着那个世界，那个刚出生的婴儿</p>
<p>诅咒着自己的出生</p>
<p>我</p>
<p>我当场全身僵硬</p>
<p>在大家的笑容之中</p>
<p>在祝福之中</p>
<p>独自一人...</p>
<p>我啊...</p>
<p>我摇摇晃晃地...</p>
<p>接近那个婴儿</p>
<p>然后想要让那个婴儿停止哭泣</p>
<p>我想着必须要那样做才行</p>
<p>为什么呢？</p>
<p>我自己也不明白...</p>
<p>那是</p>
<p>那是，自从出生以来</p>
<p>就悲惨地活到今天的我能做到的</p>
<p>我能做到的</p>
<p>唯一的</p>
<p>唯一的赎罪啊。</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21114.png" /></p>
<p>让我在这里了结了你吧…间宫卓司</p>
<p>这里是终之空的下面吧…这不刚好吗</p>
<p>跟我们的终结很相称不是吗…</p>
<p>这里，是只对你而言的，终结的天空…</p>
<p>这里就是终焉之地…</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21115.png" /></p>
<p>“不行！绝对不行！”</p>
<p>…为什么…跟过来了…</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21116.png" /></p>
<p>预定…调和吗…</p>
<p>原来如此…看来不管怎样对于你来说…我都已经毫无任何价值了对吧…</p>
<p>竟然被这家伙打倒了…真是没办法呐…</p>
<p>这也是现实吗…</p>
<p>那就接受吧…</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21117.png" /></p>
<p>不知为何，我好像看到了在夜空中挺立的向日葵…</p>
<p>只有一瞬间…</p>
<p>那株向日葵…</p>
<p>好像在某个地方…</p>
<p>向日葵…</p>
<p>跟羽咲一起…</p>
<p>是啊…</p>
<p>我是哥哥啊…</p>
<p>要是…能再多当当她的哥哥就好了……</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/21119.png" /></p>
<p>咦……</p>
<p>刚才的…</p>
<p>那个是…那片风景…</p>
<p>是吗…那片风景…</p>
<p>我也是知道的啊…</p>
<p>在坡道途中的向日葵…</p>
<p>蔚蓝的天空和向日葵。</p>
<p>漂浮着大大的云朵…</p>
<p>羽咲戴着大大的帽子…</p>
<p>然后跟我走在一起…</p>
<p>走着走着…</p>
<p>为了…</p>
<p>两人一起…</p>
<p>爬上那个坡道…</p>
<p>因为…那个坡道的前面有很漂亮的景色…</p>
<h2>题目描述</h2>
<p>您正在打galgame，然后您觉得这个gal不知所云，于是您弃坑了，开始写数据结构题：</p>
<p>给一个长为n的序列，m次操作，每次操作：</p>
<p>1、区间[l,r]加x</p>
<p>2、对于区间[l,r]，查询：</p>
<p>$a[l]^{a[l+1]^{a[l+2]^{\dots ^{a[r]}}}} \mod p$</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行两个整数 n,m 表示序列长度和操作数</p>
<p>接下来一行， n个整数 表示这个序列</p>
<p>接下来 m 行，可能是以下两种操作之一：</p>
<p>1 l r x 表示区间 [l,r]加上 x</p>
<p>2 l r p 表示对区间[l,r]进行一次查询，模数为 p</p>
<h4>输出格式</h4>
<p>对于每个询问，输出一个数表示答案。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>6 4
1 2 3 4 5 6
2 1 2 10000007
2 2 3 5
1 1 4 1
2 2 4 10</p>
<h4>输出样例 #1</h4>
<p>1
3
1</p>
<h4>输入样例 #2</h4>
<p>5 5
2 3 3 3 3
1 1 1 530739835
2 1 1 8356089
2 1 4 5496738
1 1 2 66050181
1 2 4 138625417</p>
<h4>输出样例 #2</h4>
<p>4306230
697527</p>
<h2>说明</h2>
<p>Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477</p>
<p>对于100%的数据，$n , m \le 500000$ , 序列中每个数在$[1,2\cdot 10^9]$内，$p \le 2 \cdot 10^7 $, 每次加上的数在$[0,2\cdot 10^9]$内</p>
<p>共10组数据</p>