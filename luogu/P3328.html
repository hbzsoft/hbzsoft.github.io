<h1>[SDOI2015] 音质检测</h1>
<h2>题目描述</h2>
<p>万老板希望在新的智能音乐播放设备$\operatorname{IPOOD}$中，实现对波文件音质性能的评定。离散的波文件被考虑为长度为 $N$ 的整数序列：$A_1,A_2,\cdots,A_N$。所谓的音质性能检测，可以评定任何的一个区间范围 $[L,R]$ ，音质性能取决于下述评分：</p>
<p>$$\sum_{L&lt;i&lt;R}F[A_{i-1}+1]F[A_{i+1}-1] \operatorname{mod}\;(10^9+7)$$</p>
<p>其中 $F$ 是可归纳定义的数列，满足 $F_1=1$，$F_2=2$ 且 $F_{k+2}=F_{k+1}+aF_{k}+b$ 对于任何 $k&gt;0$ 成立。</p>
<p>其中 $a$ 和 $b$ 为正整系数。为了可以为用户提供更好的服务体验，并希望对给定的波文件进行修正优化。这一款设备中，还应该支持对波文件的修改。对于给定的区间范围 $[L,R]$ ，允许用户将 $A_L$ 至 $A_R$ 同时增加一，或同时减少一。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入的第一行有两个正整数，波文件的总长度 $N$ ，和总的修改与询问次数 $Q$ 。</p>
<p>第二行有两个整数，分别表示系数 $a$ 和 $b$ 。</p>
<p>之后若干行，一共给出 $N$ 个正整数 $A_1$ 到 $A_N$ ，满足 $1\leq A_i\leq 2\times 10^9$ 。</p>
<p>之后 $Q$ 行，每行是下述三种形式之一：
- $\text{plus}\;L\;R:$将波文件数列中下标在区间 $[L,R]$ 内的元素每一个都加一。
- $\text{minus}\;L\;R:$将波文件数列中下标在区间 $[L,R]$ 内的元素每一个都减一。
- $\text{query}\;L\;R:$询问区间 $[L,R]$ 的音质性能评分。修改和询问中，均保证 $L\leq R$ ，且保证 $A_i$ 严格大于总的修改次数加一(修改操作包括 $\text{plus}$ 和 $\text{minus}$ 两种)。</p>
<h4>输出格式</h4>
<p>输出若干行，每一行对应一次询问，输出一个整数。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>7 7
1 0
3 4 5 6 7 8 9
query 2 4
query 3 7
plus 3 5
query 2 4
plus 4 7
query 3 7
query 1 7</p>
<h4>输出样例 #1</h4>
<p>64 
1766 
104 
7479 
7687</p>
<h2>说明</h2>
<p>$N\leq 3\times10^5,Q\leq10^4,0\leq a,b\leq10^9$</p>