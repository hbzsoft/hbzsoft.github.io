<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>【模板】可持久化线段树 1（可持久化数组）</h1>
<h2>题目背景</h2>
<p><strong>UPDATE : 最后一个点时间空间已经放大</strong></p>
<p>2021.9.18 增添一组 hack 数据 by @panyf</p>
<p>标题即题意</p>
<p>有了可持久化数组，便可以实现很多衍生的可持久化功能（例如：可持久化并查集）</p>
<h2>题目描述</h2>
<p>如题，你需要维护这样的一个长度为 $ N $ 的数组，支持如下几种操作</p>
<ol>
<li>
<p>在某个历史版本上修改某一个位置上的值</p>
</li>
<li>
<p>访问某个历史版本上的某一位置的值</p>
</li>
</ol>
<p>此外，每进行一次操作（<strong>对于操作2，即为生成一个完全一样的版本，不作任何改动</strong>），就会生成一个新的版本。版本编号即为当前操作的编号（从1开始编号，版本0表示初始状态数组）</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入的第一行包含两个正整数 $ N, M $， 分别表示数组的长度和操作的个数。</p>
<p>第二行包含$ N $个整数，依次为初始状态下数组各位的值（依次为 $ a_i $，$ 1 \leq i \leq N $）。</p>
<p>接下来$ M $行每行包含3或4个整数，代表两种操作之一（$ i $为基于的历史版本号）：</p>
<ol>
<li>
<p>对于操作1，格式为$ v_i \ 1 \ {loc}<em>i \ {value}_i $，即为在版本$ v_i $的基础上，将 $ a</em>{{loc}_i} $ 修改为 $ {value}_i $</p>
</li>
<li>
<p>对于操作2，格式为$ v_i \ 2 \ {loc}<em>i $，即访问版本$ v_i $中的 $ a</em>{{loc}_i} $的值，生成一样版本的对象应为vi</p>
</li>
</ol>
<h4>输出格式</h4>
<p>输出包含若干行，依次为每个操作2的结果。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>5 10
59 46 14 87 41
0 2 1
0 1 1 14
0 1 1 57
0 1 1 88
4 2 4
0 2 5
0 2 4
4 2 1
2 2 2
1 1 5 91</p>
<h4>输出样例 #1</h4>
<p>59
87
41
87
88
46</p>
<h2>说明</h2>
<p>数据规模：</p>
<p>对于30%的数据：$ 1 \leq N, M \leq {10}^3 $</p>
<p>对于50%的数据：$ 1 \leq N, M \leq {10}^4 $</p>
<p>对于70%的数据：$ 1 \leq N, M \leq {10}^5 $</p>
<p>对于100%的数据：$ 1 \leq N, M \leq {10}^6, 1 \leq {loc}_i \leq N, 0 \leq v_i &lt; i, -{10}^9 \leq a_i, {value}_i  \leq {10}^9$</p>
<p><strong>经测试，正常常数的可持久化数组可以通过，请各位放心</strong></p>
<p>~~数据略微凶残，请注意常数不要过大~~</p>
<p>~~另，此题I/O量较大，如果实在TLE请注意I/O优化~~</p>
<p>询问生成的版本是指你访问的那个版本的复制</p>
<p>样例说明：</p>
<p>一共11个版本，编号从0-10，依次为：</p>
<p>* <strong>0</strong> : 59 46 14 87 41</p>
<p>* <strong>1</strong> : 59 46 14 87 41</p>
<p>* <strong>2</strong> : 14 46 14 87 41</p>
<p>* <strong>3</strong> : 57 46 14 87 41</p>
<p>* <strong>4</strong> : 88 46 14 87 41</p>
<p>* <strong>5</strong> : 88 46 14 87 41</p>
<p>* <strong>6</strong> : 59 46 14 87 41</p>
<p>* <strong>7</strong> : 59 46 14 87 41</p>
<p>* <strong>8</strong> : 88 46 14 87 41</p>
<p>* <strong>9</strong> : 14 46 14 87 41</p>
<p>* <strong>10</strong> : 59 46 14 87 91</p>