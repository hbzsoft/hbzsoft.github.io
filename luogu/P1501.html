<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[国家集训队] Tree II</h1>
<h2>题目描述</h2>
<p>一棵 $n$ 个点的树，每个点的初始权值为 $1$。<br />
对于这棵树有 $q$ 个操作，每个操作为以下四种操作之一：</p>
<ul>
<li><code>+ u v c</code>：将 $u$ 到 $v$ 的路径上的点的权值都加上自然数 $c$；</li>
<li><code>- u1 v1 u2 v2</code>：将树中原有的边 $(u_1,v_1)$ 删除，加入一条新边 $(u_2,v_2)$，保证操作完之后仍然是一棵树；</li>
<li><code>* u v c</code>：将 $u$ 到 $v$ 的路径上的点的权值都乘上自然数 $c$；</li>
<li><code>/ u v</code>：询问 $u$ 到 $v$ 的路径上的点的权值和，将答案对 $51061$ 取模。</li>
</ul>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行两个整数 $n,q$。</p>
<p>接下来 $n-1$ 行每行两个正整数 $u,v$，描述这棵树的每条边。</p>
<p>接下来 $q$ 行，每行描述一个操作。</p>
<h4>输出格式</h4>
<p>对于每个询问操作，输出一行一个整数表示答案。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>3 2
1 2
2 3
* 1 3 4
/ 1 1</p>
<h4>输出样例 #1</h4>
<p>4</p>
<h2>说明</h2>
<p>【数据范围】 <br />
对于 $10\%$ 的数据，$1\le n,q \le 2000$； <br />
另有 $15\%$ 的数据，$1 \le n,q \le 5\times 10^4$，没有 <code>-</code> 操作，并且初始树为一条链；  <br />
另有 $35\%$ 的数据，$1 \le n,q \le 5\times 10^4$，没有 <code>-</code> 操作；<br />
对于 $100\%$ 的数据，$1\le n,q \le 10^5$，$0\le c \le 10^4$。</p>
<p>By (伍一鸣)</p>