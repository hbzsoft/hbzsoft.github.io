<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>高速公路（疑似错题）</h1>
<h2>题目描述</h2>
<p>C 国拥有一张四通八达的高速公路树。</p>
<p>C 国有 $n$ 个城市，城市之间由一共 $n-1$ 条高速公路连接。除了首都 $1$ 号城市，每个城市都有一家本地的客运公司，可以发车前往全国各地。你可以把它认作以 $1$ 为根的树。两城市的距离定义为它们之间简单路径的长度。</p>
<p>假设有一个人要从 $i$ 号城市坐车出发前往与其距离为 $D$ 的 $j$ 号城市，那么他要花费 $P_i \times D+Q_i$ 元。由于距离首都越远，国家的监管就越松，所以距离首都越远，客运公司的 $P_i$ 越大，如果 $i$ 号城市是 $j$ 号城市的某个祖先，那么一定存在 $P_i \leq P_j$。</p>
<p>小 T 成为了国家统计局的调查人员，他需要对现在的高速路网进行一次调查，了解从其他每一个城市到达首都 $1$ 号城市所花费的金钱。</p>
<p>因为可能出现多转车（或不转车）的抵达首都的方法，所以人工计算这个结果是十分复杂的。大宁非常的懒，所以请你编写一个程序解决它。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第 $1$ 行包含一个整数 $n$，表示城市的个数。</p>
<p>第 $2$ 到 $n$ 行，每行描述一个除首都之外的城市。其中第 $i$ 行包含 $4$ 个整数 $F_i,S_i,P_i,Q_i$，分别表示 $i$ 号城市的父亲城市，它到父亲城市高速公路的长度，以及乘车价格的两个参数。</p>
<h4>输出格式</h4>
<p>输出包含 $n-1$ 行，每行包含一个整数。</p>
<p>其中第 $i$ 行表示从 $i+1$ 号城市出发，到达首都最少的乘车费用。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>6
1 9 3 0
1 17 1 9
1 1 1 6
4 13 2 15
4 9 2 4</p>
<h4>输出样例 #1</h4>
<p>27
26
7
43
24</p>
<h2>说明</h2>
<h4>数据规模与约定</h4>
<ul>
<li>对于前 $40\%$ 的数据 $n \leq 1000$。</li>
<li>对于另外 $20\%$ 的数据，$F_i=i-1$</li>
<li>对于所有的数据，$1 \leq n \leq 10^6$，$0 \leq Pi,Qi \lt 2^{31}$，保证结果不会大于 $2^{63}-1$。</li>
</ul>