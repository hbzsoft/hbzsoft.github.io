<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>文艺数学题</h1>
<h2>题目背景</h2>
<p>小Y在AK曼哈顿OI，CTSC和APIO之后，开始研究数学题。</p>
<h2>题目描述</h2>
<p>小Y有一张N个点，M条边的无向图（<strong>可能有重边、自环</strong>），每条边都有一个权值w。</p>
<p>你需要计算：所有<strong>生成树的边权的最大公约数</strong>之和，具体操作见样例。</p>
<p>由于答案可能很大，需要<strong>对1000000007取模</strong>。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行两个正整数N，M，表示点数和边数。</p>
<p>接下来M行，每行三个正整数u，v，w，表示一条边连接u和v，权值为w。</p>
<h4>输出格式</h4>
<p>输出一行一个数，表示答案<strong>对1000000007取模</strong>的值。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4 5<br />
1 2 12<br />
1 3 9<br />
2 4 6<br />
3 4 8<br />
1 4 4  </p>
<h4>输出样例 #1</h4>
<p>15</p>
<h2>说明</h2>
<h3>样例1的解释</h3>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/13639.png" /> </p>
<p>显然，这张图有8个不同的生成树。</p>
<p>用$(x,y,z)$表示x,y,z的最大公约数，则答案</p>
<p>$=(12,6,8)+(6,8,9)+(8,9,12)+(9,12,6)+(9,4,6)+(12,4,8)+(12,4,9)+(6,4,8)$</p>
<p>$=2+1+1+3+1+4+1+2$</p>
<p>$=15$</p>
<h3>数据范围</h3>
<p>对于20%的数据，$N\le 10, M\le 20$；</p>
<p>对于另外10%的数据，$N\le 12, M\le 24$；</p>
<p>对于另外20%的数据，$N\le 60, M\le 3000$，且满足$u_i+1=v_i$；</p>
<p>对于另外20%的数据，$N\le 40, M\le 1000, W\le 1000$；</p>
<p>对于另外15%的数据，$N\le 50, M\le 2000$；</p>
<p>对于所有100%的数据，$N\le 60, M\le 3000, W\le 1000000$；</p>