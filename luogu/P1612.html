<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[yLOI2018] 树上的链</h1>
<h2>题目描述</h2>
<p>给定一棵有 $n$ 个节点的树。每个节点有一个点权和一个参数。节点 $i$ 的权值为 $w_i$，参数为 $c_i$。$1$ 是这棵树的根。</p>
<p>现在，对每个节点 $u$（$1 \leq u \leq n$），请在树上你找到最长的一条链 $v_1, v_2, \dots v_m$，满足如下条件：</p>
<ol>
<li>$v_1 = u$。</li>
<li>对 $2 \leq i \leq m$， 有 $v_i$ 是 $v_{i - 1}$ 的父节点。</li>
<li>链上节点的点权和不超过 $c_u$，即 $\sum_{j = 1}^m w_{v_j} \leq c_u$。 </li>
</ol>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行是一个整数，表示树的节点数 $n$。<br />
第二行有 $n - 1$ 个整数 $p_2, p_3, \dots p_n$，其中 $p_i$ 表示节点 $i$ 的父节点。<br />
第三行有 $n$ 个整数，第 $i$ 个整数表示节点 $i$ 的权值 $w_i$。<br />
第四行有 $n$ 个整数，第 $i$ 个整数表示节点 $i$ 的参数 $c_u$。</p>
<h4>输出格式</h4>
<p>输出一行 $n$ 个用空格隔开的整数，第 $i$ 个整数表示节点 $i$ 对应的链的最长长度。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>5
1 1 2 2
1 2 3 4 5
1 3 3 6 8</p>
<h4>输出样例 #1</h4>
<p>1 2 1 2 3</p>
<h2>说明</h2>
<h3>数据规模与约定</h3>
<p>对全部的测试点，保证 $1 \leq u, v \leq n \leq 10^5$，$1 \leq p_i \lt i$，$1 \leq w_i \leq c_i \leq 10^9$。</p>