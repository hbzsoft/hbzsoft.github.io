<h1>[SDOI2006] 二进制方程</h1>
<h2>题目描述</h2>
<p>一个形如：</p>
<p>X1X2…Xn=Y1Y2..Ym </p>
<p>的等式称为二进制方程。</p>
<p>在二进制方程的两边：Xi和Yj （1&lt;=i&lt;=n；1&lt;=j&lt;=m）是二进制数字（0、1）或者一个变量（小写字母）。每个变量都是一个有固定长度的二进制代码，他可以在等式中取代变量的位置，称这个长度为变量的长度。为了解一个二进制方程，需要给其中的变量赋予适当的二进制代码，使得我们用他们替代等式中的相应的变量后（等式的两边都变成二进制代码），这个等式成立。</p>
<p>编程任务：</p>
<p>对于每一个给出的方程，计算一共有多少组解。已知变量最多有26个（26个英文小写字母），且等式的每一端的数字和变量的长度之和不超过10000。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行：k（k&lt;=26,变量的个数，规定使用小写英文字母中的前k个字母作为变量，如k=5，则变量a,b,c,d,e）。</p>
<p>第二行：k个正整数，中间用一个空格隔开，依次代表k个变量的长度。</p>
<p>第三行：等式左边的表达式。</p>
<p>第四行：等式右边的表达式。</p>
<h4>输出格式</h4>
<p>等式中出现的变量共有多少组解。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>2</p>
<p>4 2</p>
<p>1b1</p>
<p>a</p>
<h4>输出样例 #1</h4>
<p>4</p>
<h4>输入样例 #2</h4>
<p>5</p>
<p>4 2 4 4 2</p>
<p>1bad1</p>
<p>acbe</p>
<h4>输出样例 #2</h4>
<p>16</p>
<h2>说明</h2>
<p>样例一：4组解</p>
<p>1 、a=1001； b=00</p>
<p>2、 a=1011； b=01</p>
<p>3、 a=1101； b=10</p>
<p>4、 a=1111； b=11）</p>
<p>样例二：K=5，变量：a,b,c,d,e。长度分别为：4 2 4 4 2。等式是：1bad1= acbe</p>
<p>输出16，即变量a,b,c,d,e共有16组解。</p>