<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[USACO09NOV] Job Hunt S</h1>
<h2>题目描述</h2>
<p>Bessie is running out of money and is searching for jobs. Farmer John knows this and wants the cows to travel around so he has imposed a rule that his cows can only make D (1 &lt;= D &lt;= 1,000) dollars in a city before they must work in another city. Bessie can, however, return to a city after working elsewhere for a while and again earn the D dollars maximum in that city. There is no limit on the number of times Bessie can do this.</p>
<p>Bessie's world comprises P (1 &lt;= P &lt;= 150) one-way paths connecting C (2 &lt;= C &lt;= 220) cities conveniently numbered 1..C. Bessie is currently in city S (1 &lt;= S &lt;= C). Path i runs one-way from city A_i to city B_i (1 &lt;= A_i &lt;= C; 1 &lt;= B_i &lt;= C) and costs nothing to traverse.</p>
<p>To help Bessie, Farmer John will give her access to his private jet service. This service features F (1 &lt;= F &lt;= 350) routes, each of which is a one way flight from one city J_i to a another K_i (1 &lt;= J_i &lt;= C; 1 &lt;= K_i &lt;= C) and which costs T_i (1 &lt;= T_i &lt;= 50,000) dollars. Bessie can pay for the tickets from future earnings if she doesn't have the cash on hand.</p>
<p>Bessie can opt to retire whenever and wherever she wants. Given an unlimited amount of time, what is the most money that Bessie can make presuming she can make the full D dollars in each city she can travel to?  Print -1 if there is no limit to this amount.</p>
<p>奶牛们正在找工作。农场主约翰知道后，鼓励奶牛们四处碰碰运气。而且他还加了一条要求：一头牛在一个城市最多只能赚D（1≤D≤1000）美元，然后它必须到另一座城市工作。当然，它可以在别处工作一阵子后又回到原来的城市再最多赚D美元。而且这样的往返次数没有限制。</p>
<p>城市间有P（1≤P≤150）条单向路径连接，共有C（2≤C≤220）座城市，编号从1到C。奶牛贝茜当前处在城市S（1≤S≤C）。路径i从城市A_i到城市B_i（1≤A_i≤C，1≤B_i≤C），在路径上行走不用任何花费。</p>
<p>为了帮助贝茜，约翰让它使用他的私人飞机服务。这项服务有F条（1≤F≤350）单向航线，每条航线是从城市J_i飞到另一座城市K_i（1≤J_i≤C，1≤K_i≤C），费用是T_i（1≤T_i≤50000）美元。如果贝茜手中没有现钱，可以用以后赚的钱来付机票钱。</p>
<p>贝茜可以选择在任何时候，在任何城市退休。如果在工作时间上不做限制，贝茜总共可以赚多少钱呢？如果赚的钱也不会出现限制，就输出-1。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行：5个用空格分开的整数D，P，C，F，S。</p>
<p>第2到第P+1行：第i+1行包含2个用空格分开的整数，表示一条从城市A_i到城市B_i的单向路径。</p>
<p>接下来F行，每行3个用空格分开的整数，表示一条从城市J_i到城市K_i的单向航线，费用是T_i。</p>
<h4>输出格式</h4>
<p>一个整数，在上述规则下最多可以赚到的钱数。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>100 3 5 2 1
1 5
2 3
1 4
5 2 150
2 5 120</p>
<h4>输出样例 #1</h4>
<p>250</p>
<h2>说明</h2>
<p>This world has five cities, three paths and two jet routes. Bessie starts out in city 1, and she can only make 100 dollars in each city before moving on.</p>
<p>Bessie can travel from city 1 to city 5 to city 2 to city 3, and make a total of 4*100 - 150 = 250 dollars.</p>
<p>Source: USACO 2009 November Silver</p>
<p>这个世界上有五个城市，三条单向路径和两条单向航线。贝茜从一号城市开始她的旅行，她在离开一个城市前最多只能在这个城市赚100美元。</p>
<p>贝茜可以通过从一号城市--&gt;五号城市--&gt;二号城市--&gt;三号城市的旅行赚到4*100-150=250美元。</p>
<p>(注:在四个城市各赚100美元,从五号城市飞到二号城市花掉150美元)</p>
<p>来源:USACO 2009 十一月银组</p>