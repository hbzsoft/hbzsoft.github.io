<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[AHOI2016初中组] 黑白序列</h1>
<h2>题目背景</h2>
<p>小可可知道小雪喜欢什么样子的黑白序列。</p>
<h2>题目描述</h2>
<p>首先，对于任何正整数 $n$，如果一个黑白序列是由连续 $n$ 个黑接上连续 $n$ 个白，那一定是小雪喜欢的黑白序列。</p>
<p>其次，如果有两个黑白序列小雪都喜欢，那么把这两个序列接起来得到的新序列，小雪也一定喜欢。小雪不会喜欢更多别的黑白序列。</p>
<p>例如，如果用字符 <code>B</code> 和 <code>W</code> 分别表示黑色，<code>W</code> 表示白色，那么 <code>BW</code>，<code>BBWW</code>，<code>BBBWWW</code> 以及 <code>BWBW</code>，<code>BWBBWW</code>，<code>BWBBWWBW</code> 都是小雪喜欢的黑白序列。而 <code>W</code>，<code>WW</code>，<code>WB</code>，<code>WBBW</code> 以及 <code>BBBWW</code> 都不是小雪喜欢的黑白序列。</p>
<p>现在小可可准备了一个未完成的黑白序列，用 <code>B</code> 和 <code>W</code> 表示黑色和白色，用 <code>?</code> 表示尚未确定，他希望知道一共有多少种不同的方法，在决定了每一个 <code>?</code> 位置的颜色后可以得到一个小雪喜欢的黑白序列。</p>
<p>两个方案若有至少一位不同才能算是不同的，不是 <code>?</code> 的位置是不允许修改的。</p>
<p>答案对 $10^9 + 9$（一个素数）取模。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行输入一个长度大于零的字符串，由 <code>B</code>，<code>W</code> 和 <code>?</code> 组成。</p>
<h4>输出格式</h4>
<p>输出一个整数，表示答案。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>B?B?????</p>
<h4>输出样例 #1</h4>
<p>6</p>
<h4>输入样例 #2</h4>
<p>??BB????W???BB??????</p>
<h4>输出样例 #2</h4>
<p>26</p>
<h4>输入样例 #3</h4>
<p>????????B???????????W??B?????W????????????????????W????????W</p>
<h4>输出样例 #3</h4>
<p>10058904</p>
<h2>说明</h2>
<h4>样例输入输出 1 解释</h4>
<p>有六种合法方案，依次得到的最终黑白序列为： </p>
<ul>
<li><code>BBBBWWWW</code>，</li>
<li><code>BBBWWWBW</code>，</li>
<li><code>BWBBBWWW</code>，</li>
<li><code>BWBBWWBW</code>，</li>
<li><code>BWBWBBWW</code>，</li>
<li><code>BWBWBWBW</code>。</li>
</ul>
<h4>数据规模与约定</h4>
<ul>
<li>对于 $20\%$ 的数据，输入长度不超过 $22$。</li>
<li>对于 $60\%$ 的数据，输入长度不超过 $5000$。</li>
<li>对于 $100\%$ 的数据，输入长度不超过 $500000$，保证序列中只含 <code>W</code>，<code>B</code>，<code>?</code> 三种字符，其中 <code>?</code> 是英文字符。</li>
</ul>