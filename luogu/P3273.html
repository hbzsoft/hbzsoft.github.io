<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[SCOI2011] 棘手的操作</h1>
<h2>题目描述</h2>
<p>有N个节点，标号从1到N，这N个节点一开始相互不连通。第i个节点的初始权值为a[i]，接下来有如下一些操作：
- U x y: 加一条边，连接第x个节点和第y个节点
- A1 x v: 将第x个节点的权值增加v
- A2 x v: 将第x个节点所在的连通块的所有节点的权值都增加v
- A3 v: 将所有节点的权值都增加v
- F1 x: 输出第x个节点当前的权值
- F2 x: 输出第x个节点所在的连通块中，权值最大的节点的权值
- F3: 输出所有节点中，权值最大的节点的权值</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入的第一行是一个整数N，代表节点个数。接下来一行输入N个整数，a[1], a[2], ..., a[N]，代表N个节点的初始权值。再下一行输入一个整数Q，代表接下来的操作数。最后输入Q行，每行的格式如题目描述所示。</p>
<h4>输出格式</h4>
<p>对于操作F1, F2, F3，输出对应的结果，每个结果占一行。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>3
0 0 0
8
A1 3 -20
A1 2 20
U 1 3
A2 1 10
F1 3
F2 3
A3 -10
F3</p>
<h4>输出样例 #1</h4>
<p>-10
10
10</p>
<h2>说明</h2>
<p>对于30%的数据，保证 N&lt;=100，Q&lt;=10000</p>
<p>对于80%的数据，保证 N&lt;=100000，Q&lt;=100000</p>
<p>对于100%的数据，保证 N&lt;=300000，Q&lt;=300000</p>
<p>对于所有的数据，保证输入合法，并且 -1000&lt;=v, a[1], a[2], ..., a[N]&lt;=1000</p>