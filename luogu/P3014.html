<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[USACO11FEB] Cow Line S</h1>
<h2>题目描述</h2>
<p>The N (1 &lt;= N &lt;= 20) cows conveniently numbered 1...N are playing yet another one of their crazy games with Farmer John. The cows will arrange themselves in a line and ask Farmer John what their line number is. In return, Farmer John can give them a line number and the cows must rearrange themselves into that line.</p>
<p>A line number is assigned by numbering all the permutations of the line in lexicographic order.</p>
<p>Consider this example:</p>
<p>Farmer John has 5 cows and gives them the line number of 3.</p>
<p>The permutations of the line in ascending lexicographic order: 1st: 1 2 3 4 5</p>
<p>2nd: 1 2 3 5 4</p>
<p>3rd: 1 2 4 3 5</p>
<p>Therefore, the cows will line themselves in the cow line 1 2 4 3 5.</p>
<p>The cows, in return, line themselves in the configuration '1 2 5 3 4' and ask Farmer John what their line number is.</p>
<p>Continuing with the list:</p>
<p>4th : 1 2 4 5 3</p>
<p>5th : 1 2 5 3 4</p>
<p>Farmer John can see the answer here is 5</p>
<p>Farmer John and the cows would like your help to play their game. They have K (1 &lt;= K &lt;= 10,000) queries that they need help with. Query i has two parts: C_i will be the command, which is either 'P' or 'Q'.</p>
<p>If C_i is 'P', then the second part of the query will be one integer A_i (1 &lt;= A_i &lt;= N!), which is a line number. This is Farmer John challenging the cows to line up in the correct cow line.</p>
<p>If C_i is 'Q', then the second part of the query will be N distinct integers B_ij (1 &lt;= B_ij &lt;= N). This will denote a cow line. These are the cows challenging Farmer John to find their line number.</p>
<p>N(1&lt;=N&lt;=20)头牛，编号为1...N，正在与FJ玩一个疯狂的游戏。奶牛会排成一行（牛线），问FJ此时的行号是多少。之后，FJ会给牛一个行号，牛必须按照新行号排列成线。</p>
<p>行号是通过以字典序对行的所有排列进行编号来分配的。比如说：FJ有5头牛，让他们排为行号3，排列顺序为：</p>
<p>1：1 2 3 4 5</p>
<p>2：1 2 3 5 4</p>
<p>3：1 2 4 3 5</p>
<p>因此，牛将在牛线1 2 4 3 5中。</p>
<p>之后，奶牛排列为“1 2 5 3 4”，并向FJ问他们的行号。继续列表：</p>
<p>4：1 2 4 5 3</p>
<p>5：1 2 5 3 4</p>
<p>FJ可以看到这里的答案是5。</p>
<p>FJ和奶牛希望你的帮助玩他们的游戏。他们需要K(1&lt;=K&lt;=10000)组查询，查询有两个部分：C_i将是“P”或“Q”的命令。</p>
<p>如果C_i是'P'，则查询的第二部分将是一个整数A_i（1 &lt;= A_i &lt;= N！），它是行号。此时，你需要回答正确的牛线。</p>
<p>如果C_i是“Q”，则查询的第二部分将是N个不同的整数B_ij（1 &lt;= B_ij &lt;= N）。这将表示一条牛线，此时你需要输出正确的行号。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>* Line 1: Two space-separated integers: N and K</p>
<p>* Lines 2..2*K+1: Line 2*i and 2*i+1 will contain a single query.</p>
<p>Line 2*i will contain just one character: 'Q' if the cows are lining up and asking Farmer John for their line number or 'P' if Farmer John gives the cows a line number.</p>
<p>If the line 2*i is 'Q', then line 2*i+1 will contain N space-separated integers B_ij which represent the cow line. If the line 2*i is 'P', then line 2*i+1 will contain a single integer A_i which is the line number to solve for.</p>
<h4>输出格式</h4>
<p>* Lines 1..K: Line i will contain the answer to query i.</p>
<p>If line 2*i of the input was 'Q', then this line will contain a single integer, which is the line number of the cow line in line 2*i+1.</p>
<p>If line 2*i of the input was 'P', then this line will contain N space separated integers giving the cow line of the number in line 2*i+1.</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>5 2 
P 
3 
Q 
1 2 5 3 4 </p>
<h4>输出样例 #1</h4>
<p>1 2 4 3 5 
5 </p>
<h2>说明</h2>
<p>感谢@prcups 提供翻译</p>