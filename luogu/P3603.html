<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>雪辉</h1>
<h2>题目背景</h2>
<p><strong>时间限制3s，空间限制512MB</strong></p>
<p>三周目的由乃被钦定成为了卡密，她立刻赶去二周目的世界寻找雪辉</p>
<p>但是按照设定，两个平行世界是没法互相影响的，也就是原则上由乃是没法去二周目世界的</p>
<p>这时候Deus又跳出来说，其实设定是作者骗你的，只要爱的力量足够强大什么都可以做到（好狗血）</p>
<p>Deus：由乃你为了雪辉是不是什么都可以做呀</p>
<p>yuno：当然啦这还用想</p>
<p>Deus：那你帮我做个题吧</p>
<p>yuno：只要不是数据结构，什么题我都做</p>
<p>Deus：出题人是那个n????????呀，他出（抄）的题除了傻逼数据结构还有啥。。。</p>
<p>yuno：你说的很有道理。。。</p>
<p>Deus：上次那个题你不是两分钟就秒了吗，这个题比那个还简单</p>
<p>yuno：（小声）其实那个是bzoj上面的大佬帮我做的</p>
<p>Deus：好吧就这么愉快的钦定了</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/4134.png" /></p>
<h2>题目描述</h2>
<p>给一个n个点的树，点有点权，有m次询问，每次询问多条链的并有多少种不同的点权以及它的mex</p>
<p>mex就是一个集合中最小的没有出现的非负整数，注意0要算</p>
<p>比如说集合是1,9,2,6,0,8,1,7，则出现了0,1,2,6,7,8,9这7种不同的点权，因为没有3所以mex是3</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/4132.png" /></p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行三个数n，m，意义如题所述，和一个数f</p>
<p>如果f是0，代表Deus没有使用膜法，如果f是1，代表Deus使用了膜法</p>
<p>之后一行n个数，表示点权</p>
<p>之后n-1行，每行两个数x，y，表示x和y节点之间有一条边，保证是一个树</p>
<p>之后m行，每行先是一个数a，表示这次输入a条链，紧接着2a个数(x1,y1)(x2,y2)...表示每条树链</p>
<p>如果数据被Deus施了膜法，这2a个数都要异或上上一个询问的答案lastans，如果是第一次询问则这个lastans = 0，因为每次询问有两个答案，lastans为这两个答案的和</p>
<p>如果没有膜法，则-1s并且不异或</p>
<h4>输出格式</h4>
<p>m行，每行两个数表示点权种类数以及mex</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>10 1 0
0 0 0 1 1 0 2 2 1 2 
2 3
1 2
4 5
3 4
7 8
6 7
5 6
9 10
8 9
1
6 8</p>
<h4>输出样例 #1</h4>
<p>2 1</p>
<h4>输入样例 #2</h4>
<p>10 1 1
0 0 1 0 0 2 2 0 0 0 
2 3
1 2
4 5
3 4
7 8
6 7
5 6
9 10
8 9
4
1 7
3 3
1 1
9 3</p>
<h4>输出样例 #2</h4>
<p>3 3</p>
<h2>说明</h2>
<p>设a的和为q</p>
<p>对于20%的数据，n,q&lt;=1000，f=0</p>
<p>对于另外30%的数据，n,q&lt;=100000，树是一条链，f=0</p>
<p>对于所有数据n,q&lt;=100000,且点权&lt;=30000</p>
<p>最后，由乃祝大家新年快乐</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/4135.png" /></p>