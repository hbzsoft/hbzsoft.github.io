<h1>不成熟的梦想家 (未熟 DREAMER)</h1>
<h2>题目背景</h2>
<p><strong>どんな未来かは 誰もまだ知らない</strong></p>
<p><strong>那是个任谁也不会知晓的未来</strong></p>
<p><strong>でも楽しくなるはずだよ</strong></p>
<p><strong>但应该会充满乐趣吧</strong></p>
<p><strong>みんなとなら乗りこえられる</strong></p>
<p><strong>只要大伙儿同在 就能跨越难关</strong></p>
<p><strong>これからなんだねお互いがんばろうよ</strong></p>
<p><strong>现在才正要开始 彼此互相加油吧</strong></p>
<p><strong>どんな未来かは 誰もまだ知らない</strong></p>
<p><strong>那是个任谁也不会知晓的未来</strong></p>
<p><strong>でも楽しくしたホントに</strong></p>
<p><strong>不过真心期望能够充满着乐趣</strong></p>
<p><strong>みんなとなら無理したくなる</strong></p>
<p><strong>只要大伙儿同在 就会想将顾虑抛诸脑后</strong></p>
<p><strong>成長したいなまだまだ未熟DREAMER</strong></p>
<p><strong>愿能有所成长 如今还只是尚未成熟的梦想家</strong></p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/4493.png" /> </p>
<p>Aqours的成员终于到齐了。</p>
<p>今天，是我们全员在一起的第一场演唱会。</p>
<p>大家都好好练习过了，相信一定会表现得很出色的。</p>
<p>不过，每个人的唱功也要尽量地接近才可以呢，如果太突出或者太落后，也是会影响表现的样子。</p>
<p>所以我们从隔壁的学园都市借来了一个发明，可以改变我们成员的唱功呢。</p>
<h2>题目描述</h2>
<p>我们Aqours的成员共有N+1人，他们会列成一队。</p>
<p>他们的唱功以A[0]到A[N]表示，A[i]$(0\le i \le N)$均给出。</p>
<p>学园都市的机器可以改变队列中连续多个成员的唱功值，并将其加上一个数Z，当然当Z是负数的时候就变成减去了。</p>
<p>我打算一共使用这个机器Q次，每次把第X到第Y号（$1\le X,Y\le10^6$）的成员都加上Z点唱功值。</p>
<p>而我们队伍的魅力值B，是这么算的：</p>
<p>一开始B=0，然后从第1号到第N号成员，</p>
<ul>
<li>当$A_{i-1}&lt;A_i$：$B = B-S\cdot|A_{i-1} - A_i|$</li>
<li>当$A_{i-1}&gt;A_i$：$B = B+T\cdot|A_{i-1} - A_i|$
其中S和T是LoveLive组委会给我们的常数。</li>
</ul>
<p>果然，我是バカチカ（笨蛋千歌）呢，所以作为领导我永远排在队伍的开头，唱功永远是0，机器也不会改到我头上呢。</p>
<p>你能帮我们算算，我<strong>每次</strong>使用完这个机器之后，成员的魅力B是多少吗？</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行4个整数，N，Q，S，T，各个变量在描述中已经解释</p>
<p>接下来N+1行，每行一个数整数Ai，其中A0=0</p>
<p>接下来Q行，每行3个整数，X，Y，Z各个变量在描述中已经解释</p>
<h4>输出格式</h4>
<p>Q个整数，表示答案。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4 3 2 3
0
5
2
4
6
1 2 1
3 4 -3
1 4 2</p>
<h4>输出样例 #1</h4>
<p>-9
-1
-5</p>
<h2>说明</h2>
<p>30% 的数据 $N,Q\le 2000$,</p>
<p>另外20% 的数据 $S=T$</p>
<p>100%的数据 $N,Q\le 200000$；$1\le S,T,A_i\le10^6$；$|Z|\le 10^6$
请注意可能需要使用int64，cin/cout可能超时。</p>
<p>样例解释：</p>
<p>第一次变化后，</p>
<p>A 0 6 3 4 6</p>
<p>B -12 -3 -5 -9</p>
<h4>以下是彩蛋</h4>
<p>没有。</p>
<p>哪来的那么多彩蛋？</p>