<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[USACO14FEB] Secret Code S</h1>
<h2>题目描述</h2>
<p>Farmer John has secret message that he wants to hide from his cows; the message is a string of length at least 2 containing only the characters A..Z.</p>
<p>To encrypt his message, FJ applies a sequence of "operations" to it, where an operation applied to a string S first shortens S by removing either some (but not all) of the initial characters or some (but not all) of the final characters from S, after which the original string S is attached either at the beginning or end.  For example, a single operation to the string ABC could result in eight possible strings:</p>
<p>AABC
ABABC
BCABC
CABC
ABCA
ABCAB
ABCBC
ABCC
Given the final encrypted string, please count the number of possible ways FJ could have produced this string using one or more repeated operations applied to some source string.  Operations are treated as being distinct even if they give the same encryption of FJ's message.  For example, there are four distinct separate ways to obtain AAA from AA.</p>
<p>Print your answer out modulo 2014.</p>
<p>农民约翰收到一条的消息，记该消息为长度至少为2，只由大写字母组成的字符串S，他通过一系列操作对S进行加密。</p>
<p>他的操作为，删除S的前面或者后面的若干个字符（但不删光整个S），并将剩下的部分连接到原字符串S的前面或者后面。如对于S=‘ABC’，共有8总可能的操作结果：</p>
<p>AABC</p>
<p>ABABC</p>
<p>BCABC</p>
<p>CABC</p>
<p>ABCA</p>
<p>ABCAB</p>
<p>ABCBC</p>
<p>ABCC</p>
<p>给出加密后的目标字符串，请计算共有多少种加密的方案。</p>
<p>对于同字符的字符串，加密方案不止一种，比如把AA加密成AAA，共有4种加密方案。将你的答案mod 2014后输出。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>* Line 1: A single encrypted string of length at most 100.</p>
<h4>输出格式</h4>
<p>* Line 1: The number of ways FJ could have produced this string with one or more successive operations applied to some initial string of length at least 2, written out modulo 2014.  If there are no such ways, output zero.</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>ABABA </p>
<h4>输出样例 #1</h4>
<p>8 </p>
<h2>说明</h2>
<p>Here are the different ways FJ could have produced ABABA:</p>
<ol>
<li>
<p>Start with ABA -&gt; AB+ABA</p>
</li>
<li>
<p>Start with ABA -&gt; ABA+BA</p>
</li>
<li>
<p>Start with AB -&gt; AB+A -&gt; AB+ABA</p>
</li>
<li>
<p>Start with AB -&gt; AB+A -&gt; ABA+BA</p>
</li>
<li>
<p>Start with BA -&gt; A+BA -&gt; AB+ABA</p>
</li>
<li>
<p>Start with BA -&gt; A+BA -&gt; ABA+BA</p>
</li>
<li>
<p>Start with ABAB -&gt; ABAB+A</p>
</li>
<li>
<p>Start with BABA -&gt; A+BABA</p>
</li>
</ol>