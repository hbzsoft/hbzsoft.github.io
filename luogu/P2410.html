<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[SDOI2009] 最优图像</h1>
<h2>题目背景</h2>
<p>小 E 在好友小 W 的家中发现一幅神奇的图画，对此颇有兴趣。</p>
<h2>题目描述</h2>
<p>这幅画可以被看做一个包含 $n \times m$ 个像素的黑白图像，为了方便起见，我们用 $0$ 表示白色像素，$1$ 表示黑色像素。小 E 认为这幅图画暗藏玄机，因此他记录下了这幅图像中每行、每列的黑色像素数量，以回去慢慢研究其中的奥妙。</p>
<p>有一天，小 W 不慎将图画打湿，原本的图像已经很难分辨。他十分着急，于是找来小 E，希望共同还原这幅图画。根据打湿后的图画，他们无法确定真正的图像，然而可以推测出每个像素原本是黑色像素的概率 $p_{i,j}\%$。那么，一个完整的图像的出现概率就可以定义为:</p>
<p>$$\prod\limits_{i = 1}^n \prod\limits_{j = 1}^{m} p_{i, j}\% \times [s_{i, j} = 1]$$</p>
<p>其中 $s_{i,j}$ 表示在还原后的图像中，像素是白色($0$)还是黑色($1$)，$[s_{i, j} = 1]$ 表示若 $s_{i, j} = 1$，则该表达式的值为 $1$，否则为 $0$。换句话说，一个完整图像出现概率就等于其所有黑色像素的出现概率之积。显然，图像的黑色像素不能包含概率为 $0$ 的像素。</p>
<p>然而，小 E 对此也无能为力。因此他们找到了会编程的小 F，也就是你，请你根据以上信息，告诉他们最有可能是原始图像的答案是什么。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行是两个整数 $n, m$，表示图像大小。</p>
<p>第 $2$ 到第 $(n + 1)$ 行，每行 $m$ 个整数，第 $(i + 1)$ 行的第 $j$ 个整数 $p_{i, j}$ 表示第 $i$ 行第 $j$ 列的像素是黑色的概率。</p>
<p>接下来一行有 $n$ 个整数，第  $i$ 个整数 $a_i$ 表示第 $i$ 行中黑色像素的个数。</p>
<p>接下来一行有 $m$ 个整数，第 $i$ 个整数 $b_i$ 表示第 $i$ 列中黑色像素的个数。</p>
<h4>输出格式</h4>
<p><strong>本题存在 Special Judge</strong>。</p>
<p>输出 $n$ 行每行一个长度为 $m$ 的只含字符 <code>0</code> 和字符 <code>1</code> 的字符串，表示答案。</p>
<p>输入数据保证至少存在一个可能的图像。如果有多种最优图像，任意输出一种即可。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>2 2
90 10
20 80
1 1
1 1</p>
<h4>输出样例 #1</h4>
<p>10
01</p>
<h2>说明</h2>
<h4>样例输入输出 1 解释</h4>
<p>共有两种可能的图像：</p>
<p><code>plain
01
10</code>
<code>plain
10
01</code>
前者的出现概率是 $0.1×0.2=0.02$，后者的出现概率是 $0.9×0.8=0.72$，故后者是最优图像。</p>
<hr />
<h4>数据规模与约定</h4>
<ul>
<li>对于 $20\%$ 的数据，保证 $n, m \leq 5$。</li>
<li>对于 $100\%$ 的数据，保证 $1 \leq n, m \leq 100$，$0 \leq p_{i, j} \leq 100$，$0 \leq a_i \leq m$，$0 \leq b_i \leq n$。</li>
</ul>
<hr />
<p>感谢 @<a href="https://www.luogu.com.cn/user/23118">test12345</a> 提供 spj。</p>