<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>小Z的神奇数列</h1>
<h2>题目背景</h2>
<p>小Z最近在研究数列，他需要知道在他所研究的数列中，最大的数是多少（Max），最小的数是多少（Min），最大的数的最小的数次幂是多少（Max^Min），所有数的乘积是多少。要知道，这样的问题是肯定难不倒小Z的。但是，最近小Z突发奇想，想要研究下这个数列的更深层的性质，所以他决定不断的从这个数列中删去一些数，每次删除后都研究下当前数列。由于数列项数很大，这给小Z带来了很大的麻烦，于是小Z请你帮他写一个程序，来完成下列操作。</p>
<h2>题目描述</h2>
<p>你需要维护一个可重集，支持五种操作：</p>
<ul>
<li>
<p><code>D x</code> 表示删除 $x$，保证 $x$ 一定存在。若有多个只用删除一个。</p>
</li>
<li>
<p><code>B</code> 询问集合中最大值。</p>
</li>
<li>
<p><code>S</code> 询问集合中最小值。</p>
</li>
<li>
<p><code>M</code> 设集合中最大值为 $a$，最小值为 $b$，询问 $a^b \bmod 317847191$。</p>
</li>
<li>
<p><code>T</code> 询问数列中所有数的乘积，对 $317847191$ 取模。</p>
</li>
</ul>
<p>对于所有询问保证集合非空。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行两个正整数 $n,m$，表示初始集合大小和操作数。  <br />
第二行 $n$ 个正整数 $a_i$，表示初始集合。<br />
接下来 $m$ 行，每行表示一个操作。</p>
<h4>输出格式</h4>
<p>对于每个询问，输出一行一个整数表示答案。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>3 6
2 6 9
M
D 9
B
S
M
T</p>
<h4>输出样例 #1</h4>
<p>81
6
2
36
12</p>
<h2>说明</h2>
<p>【数据规模】<br />
对于部分数据，$1 \le n \le 1000$，$1\le m \le 100$，$1\le a_i \le 400$；<br />
对于 $100\%$ 的数据，$1\le n,m \le 10^6$，$1\le a_i \le 10^8$。</p>