<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[SDOI2008] 递归数列</h1>
<h2>题目描述</h2>
<p>一个由自然数组成的数列按下式定义：</p>
<p>对于 $i \le k$：$a_{i}= b_{i}$。</p>
<p>对于 $i &gt; k$：$a_{i}= \sum_{j=1}^{k}{c_{j} \times a_{i-j}}$。</p>
<p>其中 $b_{1\dots k}$ 和 $c_{1\dots k}$ 是给定的自然数。</p>
<p>写一个程序，给定自然数 $m \le n$，计算 $\left( \sum_{i=m}^{n}{a_{i}} \right) \bmod p$。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行一个自然数 $k$。</p>
<p>第二行 $k$ 个自然数 $b_{1},b_{2},\dots,b_{k}$。</p>
<p>第三行 $k$ 个自然数 $c_{1},c_{2},\dots,c_{k}$。</p>
<p>第四行三个自然数 $m,n,p$。</p>
<h4>输出格式</h4>
<p>一行一个正整数，表示 $\sum_{i=m}^{n}{a_{i}} \mod p$ 的值。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>2
1 1
1 1
2 10 1000003</p>
<h4>输出样例 #1</h4>
<p>142</p>
<h2>说明</h2>
<p>对于 $20\%$ 的数据，$n \le 10^{6}$。</p>
<p>对于另外 $30\%$ 的数据，$k=1$。</p>
<p>对于 $100\%$ 的数据，$1 \le k \le 15$，$1 \le m \le n \le 10^{18}$，$0 \le b_{i},c_{i} \le 10^{9}$，$p \le 10^{8}$。</p>