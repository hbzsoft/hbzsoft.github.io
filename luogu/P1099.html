<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[NOIP2007 提高组] 树网的核</h1>
<h2>题目描述</h2>
<p>设 $T=(V,E,W)$ 是一个无圈且连通的无向图（也称为无根树），每条边都有正整数的权，我们称 $T$ 为树网（<code>treenetwork</code>），其中 $V$，$E$ 分别表示结点与边的集合，$W$ 表示各边长度的集合，并设 $T$ 有 $n$ 个结点。</p>
<p>路径：树网中任何两结点 $a$，$b$ 都存在唯一的一条简单路径，用 $d(a, b)$ 表示以 $a, b$ 为端点的路径的长度，它是该路径上各边长度之和。我们称 
$d(a, b)$ 为 $a, b$ 两结点间的距离。</p>
<p>$D(v, P)=\min{d(v, u)}$, $u$ 为路径 $P$ 上的结点。</p>
<p>树网的直径：树网中最长的路径成为树网的直径。对于给定的树网 $T$，直径不一定是唯一的，但可以证明：各直径的中点（不一定恰好是某个结点，可能在某条边的内部）是唯一的，我们称该点为树网的中心。</p>
<p>偏心距 $\mathrm{ECC}(F)$：树网 $T$ 中距路径 $F$ 最远的结点到路径 $F$ 的距离，即</p>
<p>$\mathrm{ECC}(F)=\max{D(v, F),v \in V}$</p>
<p>任务：对于给定的树网 $T=(V, E, W)$ 和非负整数 $s$，求一个路径 $F$，他是某直径上的一段路径（该路径两端均为树网中的结点），其长度不超过 $s$（可以等于 $s$），使偏心距 $\mathrm{ECC}(F)$ 最小。我们称这个路径为树网 $T=(V, E, W)$ 的核（<code>Core</code>）。必要时，$F$ 可以退化为某个结点。一般来说，在上述定义下，核不一定只有一个，但最小偏心距是唯一的。</p>
<p>下面的图给出了树网的一个实例。图中，$A-B$ 与 $A-C$ 是两条直径，长度均为 $20$。点 $W$ 是树网的中心，$EF$ 边的长度为 $5$。如果指定 $s=11$，则树网的核为路径<code>DEFG</code>（也可以取为路径<code>DEF</code>），偏心距为 $8$。如果指定 $s=0$（或 $s=1$、$s=2$），则树网的核为结点 $F$，偏心距为 $12$。</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/nzjfv4sm.png" /></p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>共 $n$ 行。</p>
<p>第 $1$ 行，两个正整数 $n$ 和 $s$，中间用一个空格隔开。其中 $n$ 为树网结点的个数，$s$ 为树网的核的长度的上界。设结点编号以此为 $1,2\dots,n$。</p>
<p>从第 $2$ 行到第 $n$ 行，每行给出 $3$ 个用空格隔开的正整数 $u, v, w$，依次表示每一条边的两个端点编号和长度。例如，<code>2 4 7</code> 表示连接结点 $2$ 与 $4$ 的边的长度为 $7$。</p>
<h4>输出格式</h4>
<p>一个非负整数，为指定意义下的最小偏心距。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>5 2
1 2 5
2 3 2
2 4 4
2 5 3</p>
<h4>输出样例 #1</h4>
<p>5</p>
<h4>输入样例 #2</h4>
<p>8 6
1 3 2
2 3 2 
3 4 6
4 5 3
4 6 4
4 7 2
7 8 3</p>
<h4>输出样例 #2</h4>
<p>5</p>
<h2>说明</h2>
<ul>
<li>对于 $40\%$ 的数据，保证 $n \le 15$。</li>
<li>对于 $70\%$ 的数据，保证 $n \le 80$。</li>
<li>对于 $100\%$ 的数据，保证 $n \le 300$，$0\le s\le10^3$，$1 \leq u, v \leq n$，$1 \leq w \leq 10^3$。</li>
</ul>