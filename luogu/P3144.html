<h1>[USACO16OPEN] Closing the Farm S</h1>
<h2>题目背景</h2>
<p><em>本题和 <a href="/problem/P6121">金组同名题目</a> 在题意上一致，唯一的不同是数据范围。</em></p>
<h2>题目描述</h2>
<p>FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。</p>
<p>这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \leq N,M \leq 3000$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。</p>
<p>FJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入第一行两个整数 $N,M$。</p>
<p>接下来 $M$ 行，每行两个整数 $u,v$（$1 \leq u,v \leq N$），描述一条连接 $u,v$ 两个农场的路。</p>
<p>最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。</p>
<h4>输出格式</h4>
<p>输出 $N$ 行，每行包含 <code>YES</code> 或 <code>NO</code>，表示某个时刻农场是否是全连通的。</p>
<p>第一行输出最初的状态，第 $i$ 行（$2 \leq i \leq N$）输出第 $i-1$ 个农场被关闭后的状态。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4 3
1 2
2 3
3 4
3
4
1
2</p>
<h4>输出样例 #1</h4>
<p>YES
NO
YES
YES</p>