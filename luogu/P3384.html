<h1>【模板】重链剖分/树链剖分</h1>
<h2>题目描述</h2>
<p>如题，已知一棵包含 $N$ 个结点的树（连通且无环），每个节点上包含一个数值，需要支持以下操作：</p>
<ul>
<li>
<p><code>1 x y z</code>，表示将树从 $x$ 到 $y$ 结点最短路径上所有节点的值都加上 $z$。</p>
</li>
<li>
<p><code>2 x y</code>，表示求树从 $x$ 到 $y$ 结点最短路径上所有节点的值之和。</p>
</li>
<li>
<p><code>3 x z</code>，表示将以 $x$ 为根节点的子树内所有节点值都加上 $z$。</p>
</li>
<li>
<p><code>4 x</code> 表示求以 $x$ 为根节点的子树内所有节点值之和</p>
</li>
</ul>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行包含 $4$ 个正整数 $N,M,R,P$，分别表示树的结点个数、操作个数、根节点序号和取模数（<strong>即所有的输出结果均对此取模</strong>）。</p>
<p>接下来一行包含 $N$ 个非负整数，分别依次表示各个节点上初始的数值。</p>
<p>接下来 $N-1$ 行每行包含两个整数 $x,y$，表示点 $x$ 和点 $y$ 之间连有一条边（保证无环且连通）。</p>
<p>接下来 $M$ 行每行包含若干个正整数，每行表示一个操作。</p>
<h4>输出格式</h4>
<p>输出包含若干行，分别依次表示每个操作 $2$ 或操作 $4$ 所得的结果（<strong>对 $P$ 取模</strong>）。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>5 5 2 24
7 3 7 8 0 
1 2
1 5
3 1
4 1
3 4 2
3 2 2
4 5
1 5 1 3
2 1 3</p>
<h4>输出样例 #1</h4>
<p>2
21</p>
<h2>说明</h2>
<p><strong>【数据规模】</strong></p>
<p>对于 $30\%$ 的数据： $1 \leq N \leq 10$，$1 \leq M \leq 10$；</p>
<p>对于 $70\%$ 的数据： $1 \leq N \leq {10}^3$，$1 \leq M \leq {10}^3$；</p>
<p>对于 $100\%$ 的数据： $1\le N \leq {10}^5$，$1\le M \leq {10}^5$，$1\le R\le N$，$1\le P \le 2^{31}-1$。</p>
<p><strong>【样例说明】</strong></p>
<p>树的结构如下：</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/2319.png" /></p>
<p>各个操作如下：</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/pic/2320.png" /></p>
<p>故输出应依次为 $2$ 和 $21$。</p>