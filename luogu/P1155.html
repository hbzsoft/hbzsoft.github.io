<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[NOIP2008 提高组] 双栈排序</h1>
<h2>题目描述</h2>
<p>Tom 最近在研究一个有趣的排序问题。如图所示，通过 $2$ 个栈 $S_1$ 和 $S_2$，Tom 希望借助以下 $4$ 种操作实现将输入序列升序排序。</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/fqln3hv1.png" /></p>
<ul>
<li>操作 $\verb!a!$：将第一个元素压入栈 $S_1$。</li>
<li>操作 $\verb!b!$：将 $S_1$ 栈顶元素弹出至输出序列。</li>
<li>操作 $\verb!c!$：将第一个元素压入栈 $S_2$。</li>
<li>操作 $\verb!d!$：将 $S_2$ 栈顶元素弹出至输出序列。</li>
</ul>
<p>如果一个 $1\sim n$ 的排列 $P$ 可以通过一系列合法操作使得输出序列为 $(1,2,\cdots,n-1,n)$，Tom 就称 $P$ 是一个“可双栈排序排列”。例如 $(1,3,2,4)$ 就是一个“可双栈排序序列”，而 $(2,3,4,1)$ 不是。下图描述了一个将 $(1,3,2,4)$ 排序的操作序列：$\texttt {a,c,c,b,a,d,d,b}$。</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/o41u6di5.png" /></p>
<p>当然，这样的操作序列有可能有几个，对于上例 $(1,3,2,4)$，$\texttt{a,b,a,a,b,b,a,b}$ 是另外一个可行的操作序列。Tom 希望知道其中字典序最小的操作序列是什么。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行是一个整数 $n$。</p>
<p>第二行有 $n$ 个用空格隔开的正整数，构成一个 $1\sim n$ 的排列。</p>
<h4>输出格式</h4>
<p>共一行，如果输入的排列不是“可双栈排序排列”，输出 <code>0</code>。</p>
<p>否则输出字典序最小的操作序列，每两个操作之间用空格隔开，行尾没有空格。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4
1 3 2 4</p>
<h4>输出样例 #1</h4>
<p>a b a a b b a b</p>
<h4>输入样例 #2</h4>
<p>4
2 3 4 1</p>
<h4>输出样例 #2</h4>
<p>0</p>
<h4>输入样例 #3</h4>
<p>3
2 3 1</p>
<h4>输出样例 #3</h4>
<p>a c a b b d</p>
<h2>说明</h2>
<p>$30\%$ 的数据满足：$n\le10$。</p>
<p>$50\%$ 的数据满足：$n\le50$。</p>
<p>$100\%$ 的数据满足：$n\le1000$。</p>
<p>2021.06.17 加强 by <a href="https://www.luogu.com.cn/user/29826">SSerxhs</a>。hack 数据单独分为一个 subtask 防止混淆。</p>