<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>角色属性树</h1>
<h2>题目描述</h2>
<p>绪萌同人社是一个有趣的组织，该组织结构是一个树形结构。有一个社长，直接下属一些副社长。每个副社长又直接下属一些部长……。</p>
<p>每个成员都有一个萌点的属性，萌点属性是由一些质数的萌元素乘积构成（例如，猫耳的值是2，弱气的值是3，黄毛的值是5，病娇的值是7，双马尾的值是11等等）</p>
<p>举个例子，正妹是双份的猫耳，而且有一份弱气，她的属性值为2*2*3=12。</p>
<p>现在组员关心一个问题，希望知道离自己最近且有相同萌元素上司是谁，例如，属性值为2、4、6、45这样的属性值都算是和正妹有相同的属性。</p>
<p>然而，组员可能会随时变化自己的属性。啊。。感觉好麻烦啊。。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行，n,k 表示成员数与询问的次数</p>
<p>第二行，n个数，分别是1~n号成员的属性值</p>
<p>接下来n-1行，x_i,y_i 表示x_i是y_i的上司。</p>
<p>接下来来k行，有两种情况</p>
<p>1 u_i 询问离u_i成员最近且有相同萌元素上司。</p>
<p>2 u_i a 更改u_i的属性值为a</p>
<h4>输出格式</h4>
<p>对于每个1类型的询问，输出符合要求的编号。如果没有符合要求的编号，输出-1。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4 6</p>
<p>10 8 4 3</p>
<p>1 2</p>
<p>2 3</p>
<p>3 4</p>
<p>1 1</p>
<p>1 2</p>
<p>1 3</p>
<p>1 4</p>
<p>2 1 9</p>
<p>1 4</p>
<h4>输出样例 #1</h4>
<p>-1</p>
<p>1</p>
<p>2</p>
<p>-1</p>
<p>1</p>
<h2>说明</h2>
<p>对于20%的数据，没有修改的操作。</p>
<p>对于50%的数据，n&lt;=100,修改次数&lt;10</p>
<p>对于100%的数据，n&lt;=200000,k&lt;100000 ,修改次数&lt;=50,a_i&lt;=2^31-1</p>
<p>UPD：本题测试数据随机，可能是假题。</p>