<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[POI2014] SUP-Supercomputer</h1>
<h2>题意翻译</h2>
<p>给定一棵 $n$ 个节点的有根树，根节点为 $1$。$q$ 次询问，每次给定一个 $k$，用最少的操作次数遍历完整棵树，输出最少操作次数。每次操作可以选择访问不超过 $k$ 个未访问的点，且这些点的父亲必须在这次操作之前被访问过。</p>
<p>$n, q \leq 10^6$。</p>
<h2>题目描述</h2>
<p>Byteasar has designed a supercomputer of novel architecture.</p>
<p><code>plain
It may comprise of many (identical) processing units.</code>
Each processing unit can execute a single instruction per time unit.</p>
<p>The programs for this computer are not sequential but rather have a tree structure.</p>
<p>Each instruction may have zero, one, or multiple subsequent instructions,    for which it is the parent instruction.</p>
<p>The instructions of the program can be executed in parallel on all available    processing units.  Moreover, they can be executed in many orders: the only    restriction is that an instruction cannot be executed unless its parent    instruction has been executed before.  For example, as many subsequent    instructions of an instruction that has been executed already can be    executed in parallel as there are processing units.</p>
<p>Byteasar has a certain program to run.  Since he likes utilizing his resources    optimally, he is wondering how the number of processing units would affect the running time.</p>
<p>He asks you to determine, for a given program and number of processing units,    the minimum execution time of the program on a supercomputer with this many processing units.</p>
<p>给定一棵N个节点的有根树，根节点为1。Q次询问，每次给定一个K，用最少的操作次数遍历完整棵树，输出最少操作次数。每次操作可以选择访问不超过K个未访问的点，且这些点的父亲必须在之前被访问过。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>In the first line of standard input, there are two integers, $n$ and $q$ ($1\le n,q\le 1\ 000\ 000$), separated by a single space, that specify the number of    instructions in Byteasar's program and the number of running time queries (for different numbers    of processing units).</p>
<p>In the second line of input, there is a sequence of $q$ integers, $k_1,k_2,\cdots,k_q$ ($1\le k_i\le 1\ 000\ 000$), separated by single spaces: $k_i$ is the number of processing units in    Byteasar's $i$-th query.</p>
<p>In the third and last input line, there is a sequence of $n-1$ integers, $a_2,a_3,\cdots,a_n$($1\le a_i&lt;i$) separated by single spaces: $a_i$ specifies the number of the parent instruction of the instruction number $i$. The instructions are numbered with successive integers from 1 to $n$, where the instruction no. 1 is the first instruction of the program.</p>
<h4>输出格式</h4>
<p>Your program should print one line consisting of $q$ integers, separated by single spaces,    to the standard output:</p>
<p>the $i$-th of these numbers should specify the minimum execution time of the program on a supercomputer with $k_i$ processing units.</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>20 1
3
1 1 1 3 4 3 2 8 6 9 10 12 12 13 14 11 11 11 11</p>
<h4>输出样例 #1</h4>
<p>8</p>