<h1>[POI2013] LAN-Colorful Chain</h1>
<h2>题目描述</h2>
<p>Little Bytie loves to play with colorful chains.</p>
<p>He already has quite an impressive collection, and some of them he likes    more than the others.</p>
<p>Each chain consists of a certain number of colorful links.</p>
<p>Byteasar has noticed that Bytie's sense of aesthetics is very precise.</p>
<p>It turns out that Bytie finds a contiguous fragment of a chain nice if    it contains exactly    <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.1.png" /> links of color <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.2.png" /> links of color <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.3.png" /> links of color <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.4.png" />,    and moreover it contains no links of other colors.</p>
<p>A chain's appeal is its number of (contiguous) fragments that are nice.</p>
<p>By trial and error, Byteasar has determined the values <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.5.png" /> and <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.6.png" />.</p>
<p>Now he would like to buy a new chain, and therefore asks you to write a program to aid him in shopping.</p>
<p>给定一个长度为 $n$ 的序列 $a$ 和 $m$ 个条件（每个条件中包含键 $c_i$ 和值 $l_i$），要求找出满足下列条件的子串的数量并输出：</p>
<ul>
<li>
<p>条件中存在键 $c_i$ 的，要求子串中 $c_i$ 恰好出现 $l_i$ 次。</p>
</li>
<li>
<p>条件中不存在键 $c_i$ 的，要求子串中不出现 $c_i$。</p>
</li>
</ul>
<p>先输入 $n$ 和 $m$，再输入 $m$ 个条件的 $l_i$，然后输入 $m$ 个条件的 $c_i$，最后输入 $a_i$。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>The first line of the standard input gives two integers, <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.7.png" /> and <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.8.png" />      (<img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.9.png" />), separated by a single space.</p>
<p>These are the length of the chain and the length of a nice fragment's description.</p>
<p>The second line gives <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.10.png" /> integers, <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.11.png" /> (<img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.12.png" />),      separated by single spaces.</p>
<p>The third line gives <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.13.png" /> integers, <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.14.png" />      (<img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.15.png" />, <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.16.png" /> for <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.17.png" />), also separated by single spaces.</p>
<p>The sequences <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.18.png" /> and <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.19.png" /> define a nice fragment of a chain - it has to contain exactly <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.20.png" /> links of color <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.21.png" />.</p>
<p>The fourth line gives <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.22.png" /> integers, <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.23.png" /> (<img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.24.png" />),      separated by single spaces, that are the colors of successive links of      the chain.</p>
<p>In tests worth 50% of total points the constraint <img alt="" src="http://main.edu.pl/images/OI20/lan-en-tex.25.png" /> holds in addition.</p>
<h4>输出格式</h4>
<p>Your program is to print a single integer, the number of nice contiguous    fragments in the chain, to the first and only line of the standard output.</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>7 3
2 1 1
1 2 3
4 2 1 3 1 2 5</p>
<h4>输出样例 #1</h4>
<p>2</p>
<h2>说明</h2>
<h3>数据范围：</h3>
<p>对于 $100\%$ 的数据，$1\leq m\leq n \leq 10^6$，$1\leq a_i,b_i,c_i\leq n$。</p>