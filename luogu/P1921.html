<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>赌博游戏【数据有误】</h1>
<h2>题目背景</h2>
<p>赌场是暴利的。大赌场通过游戏规则控制游戏的公平来赚钱。虽然规则看似很公平，但实际上是稍微有点不公平的，而大赌场由于客流量大，资金流量大，这点稍微的不公平就被放大到能让赌场得到很可观的收入。同时，这些个不公平有时并不是规则的不公平，而是道具不公平。比如说灌铅的骰子，它和正常骰子不一样，它投出 $Q$ 种点数的概率并不一样。有时，为了不让顾客察觉，他们每一次游戏结束后都有可能更换骰子。</p>
<h2>题目描述</h2>
<p>作弊的赌场有 $N$ 个骰子，在这个赌场可能发生了 $M$ 次游戏，每次游戏包括一个骰子投出的点数，我们并不知道这个骰子的编号，但知道第 $i$ 次游戏投出的点数 $O(i)$。</p>
<p>第 $i$ 个骰子投出点数 $j$ 的概率是 $A(i,j)$，用完第 $i$ 个骰子，下一次用第 $j$ 个骰子的概率为 $B(i,j)$。特别地，对于第一次游戏，用第 $i$ 个骰子的概率为 $\pi(i)$。</p>
<p>好奇的小 $v$ 来问你，在这个赌场发生这 $M$ 次游戏的概率。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>第一行两个正整数 $N,M,Q$。</p>
<p>第二行 $N$ 个浮点数，表示 $\pi(i)$。</p>
<p>第三行至 $2+N$ 行有 $N\times Q$ 个浮点数，第 $i+2$ 行 $j$ 列表示 $A(i,j)$。</p>
<p>第 $N+3$ 至 $2\times N+2$ 行有 $N\times N$ 个浮点数，第 $N+2+i$ 行 $j$ 列表示 $B(i,j)$。</p>
<p>第 $2\times N+3$ 行有 $M$ 个正整数，表示 $M$ 次游戏的结果 $O_i$，也就是每次游戏投出的点数。</p>
<h4>输出格式</h4>
<p>表示所求概率，保留四位位小数。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>3 10 3
1 0 0
0.03 0.03 0.94
0.02 0.02 0.96
0.99 0.005 0.005
0.01 0.99 0
0.05 0.05 0.90
0.98 0.002 0.008 
2 2 0 2 2 0 2 2 0 2</p>
<h4>输出样例 #1</h4>
<p>0.4483</p>
<h2>说明</h2>
<h3>数据范围及约定</h3>
<ul>
<li>对于 $30\%$ 的数据：$M \le 100$，$1 \le N$，$Q \le 10$；</li>
<li>对于 $100\%$ 的数据：$1 \le M \le 1000$，$1 \le N$，$Q \le 50$。</li>
</ul>
<p>对于矩阵 $A,B$，向量 $\pi$ 都具备概率转移的特征条件。</p>