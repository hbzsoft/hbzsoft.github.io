<h1>化学分子式</h1>
<h2>题目背景</h2>
<p>元首和元老正在共同努力学习化学，他们想让电脑帮助他模拟分子式减轻负担。请你帮他设计一个程序。</p>
<h2>题目描述</h2>
<p>你的任务是编写一个能处理在虚拟的化学里分子式的程序，在真正的化学里，每个分子式描述分子包括一个或者多个原子，但是，它可能没有真正的化学药品。</p>
<p>下面是原子符号和分子式的定义：</p>
<p>分子中一个原子由一个原子符号表示，原子符号由单个大写字母或者一个大写字母和一个小写字母组成。例如：H和He都是原子符号。</p>
<p>一个分子式是一个原子符号的非空序列，例如，HHHeHHHe是一个分子式，表示一个分子包括4个H和2个He。</p>
<p>为了方便起见，一段相同的式子，如x….x(n个X，2&lt;=n&lt;=99)，可以被缩写为（X）n。如果X是一个原子符号，那么括号可以省略。例如，HHHeHHHe也可以写作H2HeH2He,(HHHe)2,(H2He)2,((H)2He)2。</p>
<p>分子式的定义可以用一种规范的语言描述。简而言之，分子式的语法描述如下：</p>
<p>分子：原子|原子数量|（分子）数字|分子 分子<br />
原子：大写字母|大写字母 小写字母  </p>
<p>数字：2|3|4|5|……|99|<br />
大写字母：A|B|……|Z|<br />
小写字母：a|b|c|……|z|  </p>
<p>在我们这个虚拟的化学里的每一个原子都有自己的原子质量，给你原子的质量，你的程序必须输出一个用分子式表示的分子质量。分子的质量定义为所有包括的原子的质量之和。例如，假设H和He的原子质量为1和4，那么（H2He）2的分子量为12。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入格式：</p>
<p>输入由两部分组成。第一部分是原子表，由一些行组成，每行包括一个原子符号、一个或者多个空格，以及该原子的原子质量（&lt;=1000）。没有两行包含相同的原子符号。</p>
<p>第一部分最后仅包括一行字符串“END_OF_FIRST_PART”。</p>
<p>第二部分是一些行的序列。每行是一个分子式，不多于80个字符，而且不包括空格。一个分子最多包括10^5个原子，一些分子中的原子可能没有在原子表中出现。</p>
<p>最后一行仅一个零，表示输入结束。</p>
<h4>输出格式</h4>
<p>输出格式：</p>
<p>输出时一些行的序列，和输入文件的第二部分行数相同。如果分子中的每一个原子都在原子表中出现，输出一个整数，并表示分子质量。否者输出UNKNOWN。不要输出多余的字符。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>H 1
He 4
C 12
O 16
F 19
Ne 20
Cu 64
Cc 333
END_OF_FIRST_PART
H2C
(MgF)2As
Cu(OH)2
H((CO)2F)99
0</p>
<h4>输出样例 #1</h4>
<p>14
UNKNOWN
98
7426</p>