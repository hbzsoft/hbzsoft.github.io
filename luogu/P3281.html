<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[SCOI2013] 数数</h1>
<h2>题目描述</h2>
<p>Fish 是一条生活在海里的鱼，有一天他很无聊，就开始数数玩。他数数玩的具体规则是：</p>
<ol>
<li>
<p>确定数数的进制B</p>
</li>
<li>
<p>确定一个数数的区间[L, R]</p>
</li>
<li>
<p>对于[L, R] 间的每一个数，把该数视为一个字符串，列出该字符串的每一个（连续的）子串对应的B进制数的值。</p>
</li>
<li>
<p>对所有列出的数求和。现在Fish 数了一遍数，但是不确定自己的结果是否正确了。由于[L, R] 较大，他没有多余精力去验证是否正确，你能写一个程序来帮他验证吗？</p>
</li>
</ol>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入包含三行。</p>
<p>第一行仅有一个数B，表示数数的进制。</p>
<p>第二行有N +1 个数，第一个数为N，表示数L 在B 进制下的长度为N，接下里的N个数从高位到低位的表示数L 的具体每一位。</p>
<p>第三行有M+ 1 个数，第一个数为M，表示数R 在B 进制下的长度为M，接下里的M个数从高位到低位的表示数R 的具体每一位。</p>
<h4>输出格式</h4>
<p>输出仅一行，即按照Fish 数数规则的结果，结果用10 进制表示，由于该数可能很大，输出该数模上20130427的模数。</p>
<p>数据中有 $r&lt;l$ 的情况，输出的是 $-ans[r+1,l-1]\bmod 20130427$</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>10
3 1 0 3
3 1 0 3</p>
<h4>输出样例 #1</h4>
<p>120</p>
<h2>说明</h2>
<p>【样例解释】</p>
<p>[103, 103] 之间仅有数103，该数的所有子串包括1, 10, 103, 0, 03, 3，其和为120。</p>
<p>【数据范围与约定】</p>
<p>20% 数据，0 &lt;= L &lt;= R &lt;= 10^5。</p>
<p>50% 数据，2 &lt;= B &lt;= 1000，1 &lt;= N,M &lt;= 1000。</p>
<p>100% 数据，2 &lt;= B &lt;= 10^5，1 &lt;= N,M &lt;= 10^5。</p>