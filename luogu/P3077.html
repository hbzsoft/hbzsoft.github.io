<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[USACO13FEB] Route Design G</h1>
<h2>题目描述</h2>
<p>After escaping from the farm, Bessie has decided to start a travel agency along the Amoozon river.  There are several tourist sites located on both sides of the river, each with an integer value indicating how interesting the tourist site is.</p>
<p>Tourist sites are connected by routes that cross the river (i.e., there are no routes connecting a site with a site on the same side of the river).  Bessie wants to design a tour for her customers and needs your help.  A tour is a sequence of tourist sites with adjacent sites connected by a route. In order to best serve her customers she wants to find the route that maximizes the sum of the values associated with each visited site.</p>
<p>However, Bessie may be running several of these tours at the same time.  Therefore it's important that no two routes on a tour</p>
<p>intersect.  Two routes (a &lt;-&gt; x) and (b &lt;-&gt; y) intersect if and only if (a &lt; b and y &lt; x) or (b &lt; a and x &lt; y) or (a = b and x = y).</p>
<p>Help Bessie find the best tour for her agency.  Bessie may start and end at any site on either side of the Amoozon.</p>
<p>河左岸有n个点，右岸有m个点，各有权值。有R条跨河的桥，求一条不交叉的路径使得点权和最大。</p>
<p>(a &lt;-&gt; b) 与 (x &lt;-&gt; y) 交叉指(a &lt; b and y &lt; x) or (b &lt; a and x &lt; y) or (a = b and x = y)。</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>* Line 1: Three space separated integers N (1 &lt;= N &lt;= 40,000), M (1 &lt;= M &lt;= 40,000), and R (0 &lt;= R &lt;= 100,000) indicating</p>
<p>respectively the number of sites on the left side of the river, the number of sites on the right side of the river, and the number of routes.</p>
<p>* Lines 2..N+1: The (i+1)th line has a single integer, L_i (0 &lt;= L_i &lt;= 40,000), indicating the value of the ith tourist site on the left side of the river.</p>
<p>* Lines N+2..N+M+1: The (i+N+1)th line has a single integer, R_i (0 &lt;= R_i &lt;= 40,000), indicating the value of the ith tourist site on the right side of the river.</p>
<p>* Lines N+M+2..N+M+R+1: Each line contains two space separated integers I (1 &lt;= I &lt;= N) and J (1 &lt;= J &lt;= M) indicating there is a bidirectional route between site I on the left side of the river and site J on the right side of the river.</p>
<h4>输出格式</h4>
<p>* Line 1: A single integer indicating the maximum sum of values attainable on a tour.</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>3 2 4 
1 
1 
5 
2 
2 
1 1 
2 1 
3 1 
2 2 </p>
<h4>输出样例 #1</h4>
<p>8 </p>
<h2>说明</h2>
<p>There are three sites on the left side of the Amoozon with values 1, 1, and 5.  There are two sites on the right side of the Amoozon with values 2 and 2.  There are four routes connecting sites on both sides of the river.</p>
<p>The optimal tour goes from site 1 on the left, site 1 on the right, and ends at site 3 on the left.  These respectively have values 1, 2, and 5 giving a total value of the trip of 8.</p>