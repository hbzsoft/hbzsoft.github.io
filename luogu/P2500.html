<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
	    tex2jax: {
	        inlineMath: [['$','$'], ['\(','\)']],
	        processEscapes: true
	    }
	});
    </script>
</head><h1>[SDOI2012] 集合</h1>
<h2>题目描述</h2>
<p>小H在学习“集合与图论”的时候遇到了一个问题，他思考了很久依然无法很好完成这个问题。于是他只好来求助你了，给出n个点m条边的带权无向图（即每条无向边上都有一个权值），有3个集合A、B、C。一开始无向图中所有点都属于A集合，有如下9种操作：</p>
<p>MoveA x：表示将第x个点从所在集合中删除，并加入至A集合。</p>
<p>MoveB x：表示将第x个点从所在集合中删除，并加入至B集合。</p>
<p>MoveC x：表示将第x个点从所在集合中删除，并加入至C集合。</p>
<p>AskAA：询问两个端点都属于A集合的所有边中最小的权值是多少。</p>
<p>AskAB：询问两个端点分别属于A集合和B集合的所有边中最小的权值是多少。</p>
<p>AskAC：询问两个端点分别属于A集合和C集合的所有边中最小的权值是多少。</p>
<p>AskBB：询问两个端点都属于B集合的所有边中最小的权值是多少。</p>
<p>AskBC：询问两个端点分别属于B集合和C集合的所有边中最小的权值是多少。</p>
<p>AskCC：询问两个端点都属于C集合的所有边中最小的权值是多少。</p>
<p>你能帮助他解决这个问题吗？</p>
<h2>输入输出格式</h2>
<h4>输入格式</h4>
<p>输入的第1行有两个正整数，分别表示n和m。</p>
<p>在第2行至第m+1行中，每行有三个正整数，分别为u、v、w。表示这条无向边的两个端点分别为u和v(u != v)，且这个边的权值为w(w&lt;=10^9)。</p>
<p>第m+2行有一个正整数q，表示有q个询问。</p>
<p>在第m+3行至第m+q+2行中，每行的输入方式为题目描述里9种操作中的一种。</p>
<h4>输出格式</h4>
<p>对于所有的Ask操作输出最小的权值，如果不存在则输出“No Found!”。</p>
<h2>输入输出样例</h2>
<h4>输入样例 #1</h4>
<p>4 3</p>
<p>1 2 1 </p>
<p>2 3 2</p>
<p>3 1 3</p>
<p>5</p>
<p>AskAA</p>
<p>AskAB</p>
<p>MoveB 2</p>
<p>AskAA</p>
<p>AskAB</p>
<h4>输出样例 #1</h4>
<p>1</p>
<p>No Found!</p>
<p>3</p>
<p>1</p>
<h2>说明</h2>
<p>数据范围</p>
<p>对于其中20%的数据，满足n&lt;=50, m&lt;=2500, q&lt;=2500。</p>
<p>对于另外30%的数据，满足n&lt;=100, m&lt;=10000, q&lt;=20000。</p>
<p>对于另外50%的数据，满足n&lt;=100000,m&lt;=500000,q&lt;=100000。且无向图上任意两个点之间至多能选出3条不相交的路径。</p>